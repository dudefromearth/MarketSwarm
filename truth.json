{
  "version": "2.0",
  "description": "Truth: Hybrid host-based Redis deployment (system=6379, market=6380, rss=6381). Maintains prior wiring, adds explicit bus map for clarity and scaling.",
  "buses": {
    "system-redis": {
      "url": "redis://host.docker.internal:6379",
      "role": "governance",
      "description": "Primary coordination and heartbeat bus for mesh, healer, truth, and orchestration."
    },
    "market-redis": {
      "url": "redis://host.docker.internal:6380",
      "role": "market-data",
      "description": "Real-time market and chainfeed publication bus for Massive and Vexy output."
    },
    "rss-redis": {
      "url": "redis://host.docker.internal:6381",
      "role": "content",
      "description": "Dedicated RSS ingestion and semantic enrichment bus for aggregator and Vexy input."
    }
  },
  "components": {
    "rss_agg": {
      "meta": {
        "name": "Feed Aggregator",
        "description": "Ingests RSS feeds to host-based RSS Redis (rss-redis) for Vexy and publication."
      },
      "access_points": {
        "publish_to": [
          { "bus": "rss-redis", "key": "rss:queue" },
          { "bus": "system-redis", "key": "rss_agg:heartbeat" }
        ],
        "queue_key": "rss:queue",
        "index_key": "rss:index",
        "item_template": "rss:item:{uid}",
        "format_key": "rss:format"
      },
      "generate_rss": {
        "schedule": {
          "interval_sec": 600,
          "description": "Run every 10 minutes"
        }
      },
      "filters": {
        "required_fields": ["title", "abstract", "url"],
        "on_failure": "rss:quarantine"
      },
      "dependencies": [],
      "internal_config": "feeds.json"
    },
    "massive": {
      "meta": {
        "name": "Market Data Ingestor",
        "description": "Publishes market data to market-redis and system-redis for coordination."
      },
      "access_points": {
        "publish_to": [
          { "bus": "market-redis", "key": "sse:chain-feed" },
          { "bus": "system-redis", "key": "massive:spot" },
          { "bus": "system-redis", "key": "massive:heartbeat" }
        ],
        "services_key": "massive:services"
      },
      "dependencies": [],
      "api_key": "[POLYGON_API_KEY]"
    },
    "vexy_ai": {
      "meta": {
        "name": "Vexy AI Base Service",
        "description": "Subscribes to RSS and Market buses, augments, and publishes enriched outputs."
      },
      "access_points": {
        "subscribe_to": [
          { "bus": "rss-redis", "key": "rss:queue" },
          { "bus": "market-redis", "key": "sse:chain-feed" }
        ],
        "publish_to": [
          { "bus": "rss-redis", "key": "sse:vexy-message" },
          { "bus": "system-redis", "key": "vexy_ai:heartbeat" }
        ]
      },
      "dependencies": ["rss_agg", "massive"],
      "workflow": "augment_bias_gamma"
    },
    "mesh": {
      "meta": {
        "name": "Mesh Coordinator",
        "description": "Registers and monitors all active services via heartbeat."
      },
      "access_points": {
        "publish_to": [
          { "bus": "system-redis", "key": "mesh:gossip" },
          { "bus": "system-redis", "key": "mesh:heartbeat" }
        ],
        "services_key": "mesh:services"
      },
      "dependencies": []
    },
    "healer": {
      "meta": {
        "name": "Service Healer",
        "description": "Monitors the heartbeats of all services and resuscitates them when necessary."
      },
      "access_points": {
        "subscribe_to": [
          { "bus": "system-redis", "key": "rss_agg:heartbeat" },
          { "bus": "system-redis", "key": "massive:heartbeat" },
          { "bus": "system-redis", "key": "vexy_ai:heartbeat" },
          { "bus": "system-redis", "key": "mesh:heartbeat" }
        ],
        "publish_to": [
          { "bus": "system-redis", "key": "healer:alerts" },
          { "bus": "system-redis", "key": "healer:heartbeat" }
        ],
        "services_key": "healer:services"
      },
      "threshold": { "heartbeat_cadence": 30 },
      "heartbeat": {
        "channel": "healer:heartbeat",
        "interval_sec": 10,
        "redis_url": "redis://host.docker.internal:6379"
      },
      "dependencies": []
    }
  }
}